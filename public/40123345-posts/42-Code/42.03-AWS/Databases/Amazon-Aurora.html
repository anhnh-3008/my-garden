<!DOCTYPE html>
<html><head><title>🌱 Amazon Aurora</title><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:title" content="🌱 Amazon Aurora"/><meta property="og:description" content="🌿 What? § Là công nghệ độc quyền của AWS(không phải open source) Tương thích với Postgres và MySQL. Aurora là AWS cloud optimized, x5 performance so với MySQL trên RDS và x3 performance so với Postgres trên RDS."/><meta property="og:image" content="https://https://anhhn.netlify.app//static/og-image.png"/><meta property="og:width" content="1200"/><meta property="og:height" content="675"/><link rel="icon" href="../../../../static/icon.png"/><meta name="description" content="🌿 What? § Là công nghệ độc quyền của AWS(không phải open source) Tương thích với Postgres và MySQL. Aurora là AWS cloud optimized, x5 performance so với MySQL trên RDS và x3 performance so với Postgres trên RDS."/><meta name="generator" content="Quartz"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link href="../../../../index.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://fonts.googleapis.com/css2?family=IBM Plex Mono&amp;family=Dancing Script:wght@400;700&amp;family=Signika Negative:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap" rel="stylesheet" type="text/css" spa-preserve/><script src="../../../../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch(`../../../../static/contentIndex.json`).then(data => data.json())</script></head><body data-slug="40123345-posts/42-Code/42.03-AWS/Databases/Amazon-Aurora"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h1 class="page-title"><a href="../../../..">🪴 HA's Garden</a></h1><div class="spacer mobile-only"></div><div class="search"><div id="search-icon"><p>Search</p><div></div><svg tabIndex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search</title><desc id="desc">Search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></div><div id="search-container"><div id="search-space"><input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div id="results-container"></div></div></div></div><div class="darkmode"><input class="toggle" id="darkmode-toggle" type="checkbox" tabIndex="-1"/><label id="toggle-label-light" for="darkmode-toggle" tabIndex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlnsXlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35;" xmlSpace="preserve"><title>Light mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg></label><label id="toggle-label-dark" for="darkmode-toggle" tabIndex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlnsXlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'" xmlSpace="preserve"><title>Dark mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></label></div><div class="toc desktop-only"><button type="button" id="toc"><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="toc-content"><ul class="overflow"><li class="depth-0"><a href="#-what" data-for="-what">🌿 What?</a></li><li class="depth-0"><a href="#-high-availability-và-read-scaling" data-for="-high-availability-và-read-scaling">🌿 High Availability và Read Scaling</a></li><li class="depth-0"><a href="#-aurora-db-cluster" data-for="-aurora-db-cluster">🌿 Aurora DB Cluster</a></li><li class="depth-0"><a href="#-feature-of-aurora" data-for="-feature-of-aurora">🌿 Feature of Aurora</a></li><li class="depth-0"><a href="#-custom-endpoint" data-for="-custom-endpoint">🌿 Custom EndPoint</a></li><li class="depth-0"><a href="#-aurora-không-có-máy-chủ" data-for="-aurora-không-có-máy-chủ">🌿 Aurora không có máy chủ</a></li><li class="depth-0"><a href="#-aurora-multi-master" data-for="-aurora-multi-master">🌿 Aurora Multi-Master</a></li><li class="depth-0"><a href="#-global-aurora" data-for="-global-aurora">🌿 Global Aurora</a></li><li class="depth-0"><a href="#-aurora-machine-learning" data-for="-aurora-machine-learning">🌿 Aurora Machine Learning</a></li><li class="depth-0"><a href="#-aurora-backups" data-for="-aurora-backups">🌿 Aurora Backups</a></li><li class="depth-0"><a href="#-restore-options" data-for="-restore-options">🌿 Restore Options</a></li><li class="depth-0"><a href="#-aurora-database-cloning" data-for="-aurora-database-cloning">🌿 Aurora Database Cloning</a></li></ul></div></div></div><div class="center"><div class="page-header"><div class="popover-hint"><h1 class="article-title">🌱 Amazon Aurora</h1><p class="content-meta">Mar 08, 2023, 4 min read</p><ul class="tags"><li><a href="../../../../tags/aws" class="internal tag-link">#aws</a></li></ul></div></div><article class="popover-hint"><h2 id="-what">🌿 What?<a aria-hidden="true" tabindex="-1" href="#-what" class="internal"> §</a></h2>
<ul>
<li>Là công nghệ độc quyền của AWS(không phải open source)</li>
<li>Tương thích với Postgres và MySQL.</li>
<li>Aurora là <strong>AWS  cloud optimized</strong>, x5 performance so với MySQL trên RDS và x3 performance so với Postgres trên RDS.</li>
<li>Tự động tăng bộ nhớ, từ 10Gb(mặc định) có thể tăng lên 128TB</li>
<li>Aurora có 15 replicas trong khi MySQL có 5, và replication process cũng nhanh hơn(10ms)</li>
<li>Chuyển đổi dự phòng là tức thời. Đảm bảo High Available</li>
<li>Gía của Aurora đắt hơn 20% so với RDS, nhưng nó cũng hiểu quả hơn.</li>
</ul>
<h2 id="-high-availability-và-read-scaling">🌿 High Availability và Read Scaling<a aria-hidden="true" tabindex="-1" href="#-high-availability-và-read-scaling" class="internal"> §</a></h2>
<ul>
<li>Luôn tạo ra 6 bản sao ở trên 3 AZ mỗi khi ghi gì đó vào DB. Có khả năng nhân rộng, tự hồi phục cũng như tự động mở rộng.
<ul>
<li>4 bản sao trong 6 dùng để viết.</li>
<li>3 bản sao dùng để đọc</li>
</ul>
</li>
<li>Có một Aurora Instance để ghi (master)</li>
<li>Tự động chuyển đổi dự phòng nếu master có lỗi trong vòng chưa đến 30s.</li>
<li>Master + 15 read replicas</li>
<li>Hỗ trợ nhân rộng giữa các Region.</li>
</ul>
<h2 id="-aurora-db-cluster">🌿 Aurora DB Cluster<a aria-hidden="true" tabindex="-1" href="#-aurora-db-cluster" class="internal"> §</a></h2>
<p><img src="../../../../00-Meta/01-Attachments/Pasted-image-20230308141108.png" width="auto" height="auto"/></p>
<ul>
<li>Luôn chia sẻ dữ liệu lưu trữ với tất cả các cụm(master + read replicas)</li>
<li>Client connect thẳng tới master để ghi dữ liệu(writer endpoint)</li>
<li>Client conenct tới một Connection Load Balancing(reader endpoint) để truy cập đến cụm read replicas.</li>
</ul>
<h2 id="-feature-of-aurora">🌿 Feature of Aurora<a aria-hidden="true" tabindex="-1" href="#-feature-of-aurora" class="internal"> §</a></h2>
<ul>
<li>Tự động chuyển đổi dự phòng nếu có lỗi</li>
<li>Liên tục backup và recovery</li>
<li>Bảo mật và luôn sẵn sàng sử dụng</li>
<li>Tự động scaling</li>
<li>Zero downtime</li>
<li>Có thể restore data tại bất kỳ thời điểm nào.</li>
</ul>
<h2 id="-custom-endpoint">🌿 Custom EndPoint<a aria-hidden="true" tabindex="-1" href="#-custom-endpoint" class="internal"> §</a></h2>
<ul>
<li>Cho phép xác định custom endpoint để thực hiện tác vụ riêng.</li>
<li>Ví dụ cta có một cụm instance to hơn và nó tính toán tốt hơn, tạo một custom endpoint trỏ đến cụm đó để thực hiẹn các query phân tích dữ liệu(hay các query cần tính toán nhiều) để xử lý nhanh hơn.
<img src="../../../../00-Meta/01-Attachments/Pasted-image-20230308144242.png" width="auto" height="auto"/></li>
</ul>
<h2 id="-aurora-không-có-máy-chủ">🌿 Aurora không có máy chủ<a aria-hidden="true" tabindex="-1" href="#-aurora-không-có-máy-chủ" class="internal"> §</a></h2>
<ul>
<li>Tự động tạo khởi tạo cũng như scaling dựa theo tình trạng sử dụng thực tế.</li>
<li>Phù hợp với những ứng dụng không dự đoán trước được lưu lượng sử dụng.</li>
<li>Không cần lên kế hoạch sử dụng.</li>
<li>Dùng đến đâu trả đến đấy.</li>
</ul>
<h2 id="-aurora-multi-master">🌿 Aurora Multi-Master<a aria-hidden="true" tabindex="-1" href="#-aurora-multi-master" class="internal"> §</a></h2>
<ul>
<li>Trong trường hợp muốn chuyển đổi dự phòng ngay lập tức(chứ không phải đợi tầm khoảng 30s - HA), lựa chọn option này.</li>
<li>Tất cả các nodes đều được dùng để R/W và liên kết trực tiếp với client.(thay vì chuyển node chỉ đọc lên làm master)
<img src="../../../../00-Meta/01-Attachments/Pasted-image-20230308150206.png" width="auto" height="auto"/></li>
</ul>
<h2 id="-global-aurora">🌿 Global Aurora<a aria-hidden="true" tabindex="-1" href="#-global-aurora" class="internal"> §</a></h2>
<ul>
<li><strong>Aurora Cross Region Read replicas</strong>
<ul>
<li>Đề phòng thảm hoạ</li>
<li>Dễ dàng đặt ở mọi nơi</li>
</ul>
</li>
<li><strong>Aurora Global Database (khuyên dùng)</strong>
<ul>
<li>1 Primary Region(đọc/ghi)</li>
<li>Tối đa 5 regions phụ(chỉ đọc), nhân bản có ping nhỏ hơn 1s</li>
<li>Mỗi region phụ có thể có tối đa 16 read replicas, giảm độ trễ khi đọc dữ liệu</li>
<li>Khôi phục dữ liệu sau thảm hoạ trong vòng 1 phút.</li>
<li>Chưa đến một giây để sao chép toàn bộ dữ liệu trên tất cả regions.</li>
</ul>
</li>
</ul>
<h2 id="-aurora-machine-learning">🌿 Aurora Machine Learning<a aria-hidden="true" tabindex="-1" href="#-aurora-machine-learning" class="internal"> §</a></h2>
<ul>
<li>Support services:
<ul>
<li>Amazon SageMaker(dùng với bất kỳ model ML nào)</li>
<li>Amazon Comprehend (dùng để phân tích cảm tính, đề xuất sản phẩm, …)
<img src="../../../../00-Meta/01-Attachments/Pasted-image-20230308152417.png" width="auto" height="auto"/></li>
</ul>
</li>
</ul>
<h2 id="-aurora-backups">🌿 Aurora Backups<a aria-hidden="true" tabindex="-1" href="#-aurora-backups" class="internal"> §</a></h2>
<ul>
<li>Giống với RDS backups
<ul>
<li>Backup tự động
<ul>
<li>Lưu trữ trong 1-35 ngày</li>
<li>Backup tại tất cả các thời điểm, vì vậy chúng ta có thể lấy lại dữ liệu tại bất kỳ thời điểm nào.</li>
</ul>
</li>
<li>Backup thủ công
<ul>
<li>User tự thực hiện</li>
<li>Lưu trữ vô thời hạn</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="-restore-options">🌿 Restore Options<a aria-hidden="true" tabindex="-1" href="#-restore-options" class="internal"> §</a></h2>
<ul>
<li>Restoring từ Aurora backup hoặc snapshot tạo một database mới.</li>
<li>Restoring MySQL Aurora cluster từ S3
<ul>
<li>Tạo một backup sử dụng Percona XtraBackup</li>
<li>Lưu file backup vào S3</li>
<li>Restore từ file backup đó</li>
</ul>
</li>
</ul>
<h2 id="-aurora-database-cloning">🌿 Aurora Database Cloning<a aria-hidden="true" tabindex="-1" href="#-aurora-database-cloning" class="internal"> §</a></h2>
<ul>
<li>Tạo một Database Cluster mới từ cái có sẵn.</li>
<li>Nhanh hơn snapshot&amp;restore</li>
<li>Một DB mới được tạo ra, giống y hệt cái cũ nhưng không đồng bộ(ko liên quan gì đến nhau, vd một cái dùng cho staging, mọt cái dùng cho production)</li>
<li>Rất nhanh và giá cả phải chăng</li>
<li>Hữu ích khi muốn tạo một staging database từ production database và không ảnh hưởng đến môi trường production.</li>
</ul></article></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div id="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1}"></div><svg version="1.1" id="global-graph-icon" xmlns="http://www.w3.org/2000/svg" xmlnsXlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xmlSpace="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
	s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
	c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
	C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
	c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
	v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
	s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
	C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
	S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
	s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
	s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></div><div id="global-graph-outer"><div id="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1}"></div></div></div><div class="backlinks"><h3>Backlinks</h3><ul class="overflow"><li><a href="../../../../40123345-posts/42-Code/42.03-AWS/Databases/Database-in-AWS" class="internal">🌱 Database in AWS</a></li><li><a href="../../../../40123345-posts/42-Code/42.03-AWS/Disaster-Recovery/AWS-Backup" class="internal">🌱 AWS Backup</a></li><li><a href="../../../../40123345-posts/42-Code/42.03-AWS/Disaster-Recovery/DMS---Database-Migration-Service" class="internal">🌱 DMS - Database Migration Service</a></li><li><a href="../../../../40123345-posts/42-Code/42.03-AWS/Disaster-Recovery/Disaster-Recovery-Overview" class="internal">🌱 Disaster Recovery Overview</a></li></ul></div></div></div><footer><hr/><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.0.10</a>, © 2023</p><ul><li><a href="https://github.com/jackyzha0/quartz">GitHub</a></li><li><a href="https://discord.gg/cRFFHYye7t">Discord Community</a></li></ul></footer></div></body><script type="application/javascript">// quartz/components/scripts/quartz/components/scripts/callout.inline.ts
function toggleCallout() {
  const outerBlock = this.parentElement;
  outerBlock.classList.toggle(`is-collapsed`);
  const collapsed = outerBlock.classList.contains(`is-collapsed`);
  const height = collapsed ? this.scrollHeight : outerBlock.scrollHeight;
  outerBlock.style.maxHeight = height + `px`;
  let current = outerBlock;
  let parent = outerBlock.parentElement;
  while (parent) {
    if (!parent.classList.contains(`callout`)) {
      return;
    }
    const collapsed2 = parent.classList.contains(`is-collapsed`);
    const height2 = collapsed2 ? parent.scrollHeight : parent.scrollHeight + current.scrollHeight;
    parent.style.maxHeight = height2 + `px`;
    current = parent;
    parent = parent.parentElement;
  }
}
function setupCallout() {
  const collapsible = document.getElementsByClassName(
    `callout is-collapsible`
  );
  for (const div of collapsible) {
    const title = div.firstElementChild;
    if (title) {
      title.removeEventListener(`click`, toggleCallout);
      title.addEventListener(`click`, toggleCallout);
      const collapsed = div.classList.contains(`is-collapsed`);
      const height = collapsed ? title.scrollHeight : div.scrollHeight;
      div.style.maxHeight = height + `px`;
    }
  }
}
document.addEventListener(`nav`, setupCallout);
window.addEventListener(`resize`, setupCallout);
</script><script type="module">
          import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
          const darkMode = document.documentElement.getAttribute('saved-theme') === 'dark'
          mermaid.initialize({
            startOnLoad: false,
            securityLevel: 'loose',
            theme: darkMode ? 'dark' : 'default'
          });
          document.addEventListener('nav', async () => {
            await mermaid.run({
              querySelector: '.mermaid'
            })
          });
          </script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/copy-tex.min.js" type="application/javascript"></script><script type="application/javascript">
          const socket = new WebSocket('ws://localhost:3001')
          socket.addEventListener('message', () => document.location.reload())
        </script><script src="../../../../postscript.js" type="module"></script></html>