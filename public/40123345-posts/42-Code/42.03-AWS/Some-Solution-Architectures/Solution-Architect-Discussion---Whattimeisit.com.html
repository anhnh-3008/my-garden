<!DOCTYPE html>
<html><head><title>🌱 Solution Architect Discussion - Whattimeisit.com</title><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:title" content="🌱 Solution Architect Discussion - Whattimeisit.com"/><meta property="og:description" content="Đề bài: Tôi cần build kiến trúc cho một web xem thời gian, có domain là whattimeisit.com Đây là một app hỏi giờ thôi nên không cần database để lưu dữ liệu."/><meta property="og:image" content="https://https://anhhn.netlify.app//static/og-image.png"/><meta property="og:width" content="1200"/><meta property="og:height" content="675"/><link rel="icon" href="../../../../static/icon.png"/><meta name="description" content="Đề bài: Tôi cần build kiến trúc cho một web xem thời gian, có domain là whattimeisit.com Đây là một app hỏi giờ thôi nên không cần database để lưu dữ liệu."/><meta name="generator" content="Quartz"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link href="../../../../index.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://fonts.googleapis.com/css2?family=IBM Plex Mono&amp;family=Dancing Script:wght@400;700&amp;family=Signika Negative:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap" rel="stylesheet" type="text/css" spa-preserve/><script src="../../../../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch(`../../../../static/contentIndex.json`).then(data => data.json())</script></head><body data-slug="40123345-posts/42-Code/42.03-AWS/Some-Solution-Architectures/Solution-Architect-Discussion---Whattimeisit.com"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h1 class="page-title"><a href="../../../..">🪴 HA's Garden</a></h1><div class="spacer mobile-only"></div><div class="search"><div id="search-icon"><p>Search</p><div></div><svg tabIndex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search</title><desc id="desc">Search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></div><div id="search-container"><div id="search-space"><input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div id="results-container"></div></div></div></div><div class="darkmode"><input class="toggle" id="darkmode-toggle" type="checkbox" tabIndex="-1"/><label id="toggle-label-light" for="darkmode-toggle" tabIndex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlnsXlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35;" xmlSpace="preserve"><title>Light mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg></label><label id="toggle-label-dark" for="darkmode-toggle" tabIndex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlnsXlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'" xmlSpace="preserve"><title>Dark mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></label></div></div><div class="center"><div class="page-header"><div class="popover-hint"><h1 class="article-title">🌱 Solution Architect Discussion - Whattimeisit.com</h1><p class="content-meta">Mar 12, 2023, 3 min read</p><ul class="tags"><li><a href="../../../../tags/aws" class="internal tag-link">#aws</a></li><li><a href="../../../../tags/architecture" class="internal tag-link">#architecture</a></li></ul></div></div><article class="popover-hint"><ul>
<li>Đề bài: Tôi cần build kiến trúc cho một web xem thời gian, có domain là <strong>whattimeisit.com</strong></li>
</ul>
<ol>
<li>
<p>Đây là một app hỏi giờ thôi nên không cần database để lưu dữ liệu. Đầu tiên tôi cần launch một EC2 Instance + ElasticIP để người dùng có thể truy cập để hỏi giờ.
<img src="../../../../00-Meta/01-Attachments/Pasted-image-20230312115417.png" width="auto" height="auto"/></p>
</li>
<li>
<p>Sau đó, app được người dùng trải nghiệm tốt, họ giới thiệu cho bạn bè, một vài người sử dụng thử và lượng truy cập tăng lên. Tôi cần phải năng cấp Instance để đáp ứng nhu cầu sử dụng, lúc đầu là T2 -> M5.</p>
<ol>
<li>Stop Instance đang chạy</li>
<li>Đổi thủ công từ T2 -M5</li>
<li>Lauch lại Instance, vì sử dụng Elastic IP nên không ảnh hướng đến địa chỉ truy cập.
<img src="../../../../00-Meta/01-Attachments/Pasted-image-20230312121026.png" width="auto" height="auto"/></li>
</ol>
</li>
</ol>
<ul>
<li>Trong thời gian upgrade, người dùng không thể truy cập để hỏi giờ được, thời gian downtime sẽ ảnh hưởng đến trải nghiệm của người dùng. Nhưng vì giờ app nó vẫn còn nhỏ, nên thôi cứ dùng tạm vậy đã.</li>
</ul>
<ol start="3">
<li>
<p>Sau đó app thật sự nổi tiếng, lượng truy cập ồ ạt, tiếp theo tôi sẽ thực hiện scaling horizontal.
<img src="../../../../00-Meta/01-Attachments/Pasted-image-20230312165841.png" width="auto" height="auto"/></p>
</li>
<li>
<p>Vấn đề là người dùng sẽ phải nhớ địa chỉ IP tương ứng với từng instance để truy cập, về sau càng scale lên càng nhiều instances, việc nhớ IPs là rất bất tiện. Để giải quyết vấn đề này, tôi sử dụng <strong>Route 53</strong> để điều hướng địa chỉ IP cho người dùng.
<img src="../../../../00-Meta/01-Attachments/Pasted-image-20230312171324.png" width="auto" height="auto"/></p>
</li>
<li>
<p>Nhưng hiện tại, nhu cầu scale là thường xuyên, việc add instance thêm hoặc đặc biệt là remove sẽ gây bất tiện. Do TTL được set là 1 giờ, nếu instance bị xóa thì trong một giờ nhóm user có response DNS sẽ không thể sử dụng được app, ảnh hưởng đến trải nghiệm. Ở bước này, tôi đầu tư thêm tiền để thực hiện scale horizontal bằng <strong>ELS - Elastic Load Balancer</strong>.</p>
<ul>
<li>Vì ELB sẽ có IP thay đổi nên tôi bật alias trong DNS record lên, trỏ về ELB.</li>
</ul>
</li>
<li>
<p>Cơ mà thấy phải scale thủ công cũng hơi bất tiện, thế là tôi dùng thêm dịch vụ <strong>ASG - Auto Scaling Group</strong> để tự động scale.</p>
</li>
<li>
<p>Bật thêm <strong>Multi-AZ</strong> để phòng tránh trường hợp bất ngờ như động đất sóng thần gì đấy làm hỏng một AZ, các AZ còn lại sẽ vẫn hoạt động bình thường.</p>
</li>
<li>
<p>Ok, giờ thì optimize cost một chút, tôi biết rằng chắc chắn mỗi năm sẽ cần ít nhất 2 instances để chạy app, tôi sẽ lựa chọn option <strong>reserved instance</strong> để thuê 2 instances cho 2 AZs, còn lại phát sinh tôi sẽ dùng option <strong>spot instances</strong> để tiết kiệm chi phí.</p>
</li>
</ol>
<blockquote class="callout" data-callout="note">
<div class="callout-title">
                  <div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="2" x2="22" y2="6"></line><path d="M7.5 20.5 19 9l-4-4L3.5 16.5 2 22z"></path></svg></div>
                  <div class="callout-title-inner"><p>Summary </p></div>
                  
                </div>
<p>Các bước bên trên là các bước để tạo nên một kiến trúc tốt trên nền tảng AWS, nó bao gồm 5/6 trụ cột</p>
<ol>
<li>operation pillar - vận hành tốt, đáp ứng nhu cầu mở rộng tự động và hợp lý cho hệ thống</li>
<li>reliability pillar - uy tín, luôn định tuyến tới các healthy instance cũng như có dự phòng ngay khi xảy ra lỗi.</li>
<li>performance pillar - đáp ứng khả năng xử lý, tính toán tốt cho hệ thống</li>
<li>security pillar - các rules được thiết lập chặt chẽ, các requests sẽ được đi qua đúng các điểm chỉ định để đảm bảo tính an toàn cho hệ thống.</li>
<li>optimize cost pilllar - chi phí sử dụng được tối ưu với những options của các dịch vụ phù hợp với nhu cầu sử dụng của ứng dụng.</li>
</ol>
</blockquote></article></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div id="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1}"></div><svg version="1.1" id="global-graph-icon" xmlns="http://www.w3.org/2000/svg" xmlnsXlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xmlSpace="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
	s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
	c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
	C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
	c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
	v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
	s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
	C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
	S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
	s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
	s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></div><div id="global-graph-outer"><div id="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1}"></div></div></div><div class="backlinks"><h3>Backlinks</h3><ul class="overflow"><li>No backlinks found</li></ul></div></div></div><footer><hr/><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.0.10</a>, © 2023</p><ul><li><a href="https://github.com/jackyzha0/quartz">GitHub</a></li><li><a href="https://discord.gg/cRFFHYye7t">Discord Community</a></li></ul></footer></div></body><script type="application/javascript">// quartz/components/scripts/quartz/components/scripts/callout.inline.ts
function toggleCallout() {
  const outerBlock = this.parentElement;
  outerBlock.classList.toggle(`is-collapsed`);
  const collapsed = outerBlock.classList.contains(`is-collapsed`);
  const height = collapsed ? this.scrollHeight : outerBlock.scrollHeight;
  outerBlock.style.maxHeight = height + `px`;
  let current = outerBlock;
  let parent = outerBlock.parentElement;
  while (parent) {
    if (!parent.classList.contains(`callout`)) {
      return;
    }
    const collapsed2 = parent.classList.contains(`is-collapsed`);
    const height2 = collapsed2 ? parent.scrollHeight : parent.scrollHeight + current.scrollHeight;
    parent.style.maxHeight = height2 + `px`;
    current = parent;
    parent = parent.parentElement;
  }
}
function setupCallout() {
  const collapsible = document.getElementsByClassName(
    `callout is-collapsible`
  );
  for (const div of collapsible) {
    const title = div.firstElementChild;
    if (title) {
      title.removeEventListener(`click`, toggleCallout);
      title.addEventListener(`click`, toggleCallout);
      const collapsed = div.classList.contains(`is-collapsed`);
      const height = collapsed ? title.scrollHeight : div.scrollHeight;
      div.style.maxHeight = height + `px`;
    }
  }
}
document.addEventListener(`nav`, setupCallout);
window.addEventListener(`resize`, setupCallout);
</script><script type="module">
          import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
          const darkMode = document.documentElement.getAttribute('saved-theme') === 'dark'
          mermaid.initialize({
            startOnLoad: false,
            securityLevel: 'loose',
            theme: darkMode ? 'dark' : 'default'
          });
          document.addEventListener('nav', async () => {
            await mermaid.run({
              querySelector: '.mermaid'
            })
          });
          </script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/copy-tex.min.js" type="application/javascript"></script><script type="application/javascript">
          const socket = new WebSocket('ws://localhost:3001')
          socket.addEventListener('message', () => document.location.reload())
        </script><script src="../../../../postscript.js" type="module"></script></html>