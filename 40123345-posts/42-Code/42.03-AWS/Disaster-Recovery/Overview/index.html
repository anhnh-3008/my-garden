<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="🌿 What? Bất kỳ sự kiện nào gây ảnh hưởng tiêu cực tới quá trình nghiệp vụ liên tục hoặc vấn đề tài chính của một công ty thì đó được gọi là disaster(hay còn được gọi là incident)"><title>🥦 Fill title</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://anhhn.netlify.app//icon.png><link href=https://anhhn.netlify.app/styles.fffdfa86ac55060b53797e4fb7b830fd.min.css rel=stylesheet><link href=https://anhhn.netlify.app/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://anhhn.netlify.app/js/darkmode.183fcede5b91e00cd4379bf6fc1fe35f.min.js></script>
<script src=https://anhhn.netlify.app/js/util.9825137f5e7825e8553c68ce39ac9e44.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://anhhn.netlify.app/js/popover.9b72b70bd35617d0635e9d15463662b2.min.js></script>
<script src=https://anhhn.netlify.app/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://anhhn.netlify.app/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://anhhn.netlify.app/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="https://anhhn.netlify.app/",fetchData=Promise.all([fetch("https://anhhn.netlify.app/indices/linkIndex.a7fe2397a5dd48d5b511c9e757d93268.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://anhhn.netlify.app/indices/contentIndex.82b37ebe9eb1f41a2a6423fa2a0d869c.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://anhhn.netlify.app",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://anhhn.netlify.app",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{"’":"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/anhhn.netlify.app\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-HDBMVFQGBH"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-HDBMVFQGBH",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://anhhn.netlify.app/js/full-text-search.24827f874defbbc6d529926cbfcfb493.min.js></script><div class=singlePage><header><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js></script><h1 id=page-title><a href=https://anhhn.netlify.app/>Home</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>🥦 Fill title</h1><p class=meta>Last updated
Apr 20, 2023
<a href=https://github.com/anhnh-3008/quartz/tree/hugo/content/40123345%20posts/42%20Code/42.03%20AWS/Disaster%20Recovery/Overview.md rel=noopener>Edit Source</a></p><ul class=tags><li><a href=https://anhhn.netlify.app/tags/aws/>Aws</a></li></ul><aside class=mainTOC><details open><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#-what>🌿 What?</a></li><li><a href=#-strategies>🌿 Strategies</a><ol><li><a href=#-backup-and-restore-high-rpo>🍃 Backup and Restore (High RPO)</a></li><li><a href=#-pilot-light>🍃 Pilot Light</a></li><li><a href=#-warm-standby>🍃 Warm Standby</a></li><li><a href=#-multi-site>🍃 Multi Site</a></li></ol></li><li><a href=#-tips>🌿 Tips</a></li></ol></nav></details></aside><a href=#-what><h2 id=-what><span class=hanchor arialabel=Anchor># </span>🌿 What?</h2></a><ul><li><p>Bất kỳ sự kiện nào gây ảnh hưởng tiêu cực tới quá trình nghiệp vụ liên tục hoặc vấn đề tài chính của một công ty thì đó được gọi là disaster(hay còn được gọi là incident)</p></li><li><p>Disaster Recovery(DC) là các hoạt động được chuẩn bị để thực hiện quá trình hồi phục sau khi xuất hiện một disaster.</p></li><li><p>Các loại DC:</p><ul><li>On-premise => On-premise: thuê một datacenter đặt ở Hà Nội, một cái đặt ở Hải Phòng chẳng hạn.</li><li>On-premise => Cloud: Hybrid Recovery - có một máy chủ vật lý đặt ở cty, thuê thêm datacenter trên cloud, nếu on-premise có vấn đề thì switch qua cloud sài.</li><li>Cloud Region => Cloud Region</li></ul></li><li><p>Phân biệt 2 định nghĩa:</p><ul><li>RPO - Recovery Point Objective - bao nhiêu dữ liệu bị mất khi xảy ra disaster</li><li>RTO - Recovery Time Objective - thời gian downtime là bao lâu kể từ thời điểm phát sinh disater.
=> Việc của chúng ta làm làm cách nào đó tối ưu Data loss và Downtime càng nhỏ càng tốt.
<img src="/00 Meta/01 Attachments/Pasted image 20230420152447.png" width=auto class=myImg></li></ul></li></ul><a href=#-strategies><h2 id=-strategies><span class=hanchor arialabel=Anchor># </span>🌿 Strategies</h2></a><p><img src="/00 Meta/01 Attachments/Pasted image 20230420152835.png" width=auto class=myImg></p><ul><li>4 strategies sắp xếp theo thời gian Downtime, cũng như giá tiền, càng đắt thời gian Downtime càng nhỏ.</li></ul><a href=#-backup-and-restore-high-rpo><h3 id=-backup-and-restore-high-rpo><span class=hanchor arialabel=Anchor># </span>🍃 Backup and Restore (High RPO)</h3></a><p><img src="/00 Meta/01 Attachments/Pasted image 20230420153524.png" width=auto class=myImg></p><ul><li>Đặt lịch để datacenter tự động tạo snapshot, hoặc với on-premise thì gửi dữ liệu lên Cloud. Cách này thì không cần setup gì nhiều, giá còn rẻ.</li><li>Cơ mà cách này thì nó dễ High RPO và RTO khi có disaster.<ul><li>Vd như dùng AWS Snowball để chuyển dữ liệu tầm 7 ngày, trong thời gian di chuyển, on-premise nó cháy phát, thế là mất toàn bộ data trong 1 tuần luôn.</li><li>Hoặc tạo snapshot 24h hoặc 1h một lần thì nếu có disaster, hệ thống cx sẽ mất toàn bộ dữ liệu trong thời gian countdown đó.</li></ul></li><li>Ngoài ra còn một số hạn chế cần xem xét khi triển khai:<ul><li>Mất thời gian và tài nguyên để thực hiện sao lưu.</li><li>Không thể khôi phục ngay lập tức, khi xảy ra disater, dữ liệu chưa thể sử dụng ngay được mà sẽ có một khoảng downtime để khôi phục lại dữ liệu.</li><li>Nói là rẻ nhưng chúng ta cũng phải mất thêm phí để trả cho việc lưu trữ, băng tần sao lưu, &mldr;</li></ul></li></ul><a href=#-pilot-light><h3 id=-pilot-light><span class=hanchor arialabel=Anchor># </span>🍃 Pilot Light</h3></a><p><img src="/00 Meta/01 Attachments/Pasted image 20230420161932.png" width=auto class=myImg></p><ul><li>Là chiến lược duy trì một bản sao của hệ thống, bản sao này sẽ chỉ bao gồm các phần quan trọng của hệ thống(vd như <a href=/40123345-posts/42-Code/42.03-AWS/Databases/Amazon-RDS-Relational-Database-Service rel=noopener class=internal-link data-src=/40123345-posts/42-Code/42.03-AWS/Databases/Amazon-RDS-Relational-Database-Service>RDS</a>, EC2 thì lúc nào sử dụng tạo sau nên không cần), duy trì ở mức tối thiểu để tối ưu chi phí.</li><li>Như ví dụ trên, khi disaster xảy ra, hệ thống sẽ điều hướng để chạy trên bản sao, từ đó giúp giảm thiểu RTO, cũng như dữ liệu luôn được nhân bản liên tục, giảm thiểu RPO.</li><li>Hạn chế:<ul><li>Chi phí để duy trì bản sao</li><li>Cần có một kế hoạch chi tiết để thực hiện hồi phục nhanh chóng và chính xác. Chiến lược này liên quan nhiều đến cấu hình, kích thước, tài nguyên, network, và nhiều yếu tố khác của hệ thống.</li></ul></li></ul><a href=#-warm-standby><h3 id=-warm-standby><span class=hanchor arialabel=Anchor># </span>🍃 Warm Standby</h3></a><p><img src="/00 Meta/01 Attachments/Pasted image 20230420164451.png" width=auto class=myImg></p><ul><li>Giống Spot Light, cũng duy trì một bản sao dự phòng nhưng bản sao này sẽ chạy thêm cả các dịch vụ chính của hệ thống.</li><li>Bên trên không chạy EC2 Instances thì chiến lược này sẽ có chạy sẵn để tạch thì chạy luôn, chứ không có downtime để launch EC2 Instance nữa.</li><li>Hạn chế:<ul><li>Chi phí tất nhiêu là nhiều hơn rồi, đắt luôn ấy chứ.</li><li>Có thể bản sao sẽ không đáp ứng được đầy đủ lượng traffic của hệ thống cũ, lúc này thì vẫn cần thời gian để scale trước khi hoàn toàn ổn định.</li></ul></li></ul><a href=#-multi-site><h3 id=-multi-site><span class=hanchor arialabel=Anchor># </span>🍃 Multi Site</h3></a><p><img src="/00 Meta/01 Attachments/Pasted image 20230420165605.png" width=auto class=myImg></p><ul><li>Phiên bản khô máu, chạy song song 2 phiên bản poroduction luôn, nó cái nào gặp lỗi, điều hướng qua cái còn lại để sử dụng.</li><li>Rất đắt.</li><li>Downtime hầu như rất thấp mấy giây, cùng lắm là mấy phút thôi.</li></ul><a href=#-tips><h2 id=-tips><span class=hanchor arialabel=Anchor># </span>🌿 Tips</h2></a><ul><li><strong>Backup</strong><ul><li><a href=/40123345-posts/42-Code/42.03-AWS/EBS-Volume-Elastic-Block-Store rel=noopener class=internal-link data-src=/40123345-posts/42-Code/42.03-AWS/EBS-Volume-Elastic-Block-Store>EBS</a> snapshots, <a href=/40123345-posts/42-Code/42.03-AWS/Databases/Amazon-RDS-Relational-Database-Service rel=noopener class=internal-link data-src=/40123345-posts/42-Code/42.03-AWS/Databases/Amazon-RDS-Relational-Database-Service>RDS</a> auto snapshot, &mldr;</li><li>Thường xuyên push lên <a href=/40123345-posts/42-Code/42.03-AWS/S3 rel=noopener class=internal-link data-src=/40123345-posts/42-Code/42.03-AWS/S3>S3</a>/<a href=/40123345-posts/42-Code/42.03-AWS/S3 rel=noopener class=internal-link data-src=/40123345-posts/42-Code/42.03-AWS/S3>S3</a> Glacier, &mldr; dùng lifecycle policies</li><li>Nếu chạy cả trên on-premise: sử dụng Snowball hoặc Storage Gateway</li></ul></li><li><strong>High Availability</strong><ul><li>Dùng Route53 để migrate DNS trên nhiều Regions.</li><li><a href=/40123345-posts/42-Code/42.03-AWS/Databases/Amazon-RDS-Relational-Database-Service rel=noopener class=internal-link data-src=/40123345-posts/42-Code/42.03-AWS/Databases/Amazon-RDS-Relational-Database-Service>RDS</a>/<a href=/40123345-posts/42-Code/42.03-AWS/Databases/Amazon-ElastiCache rel=noopener class=internal-link data-src=/40123345-posts/42-Code/42.03-AWS/Databases/Amazon-ElastiCache>ElastiCache</a> Multi-AZs, EFS, <a href=/40123345-posts/42-Code/42.03-AWS/S3 rel=noopener class=internal-link data-src=/40123345-posts/42-Code/42.03-AWS/S3>S3</a>, &mldr;</li><li><a href=/40123345-posts/42-Code/42.03-AWS/Networking-VPC/AWS-Site-to-Site-VPC rel=noopener class=internal-link data-src=/40123345-posts/42-Code/42.03-AWS/Networking-VPC/AWS-Site-to-Site-VPC>Site-to-site</a> để recovery cho <a href=/40123345-posts/42-Code/42.03-AWS/Networking-VPC/Direct-Connect-DX rel=noopener class=internal-link data-src=/40123345-posts/42-Code/42.03-AWS/Networking-VPC/Direct-Connect-DX>Direct Connect</a></li></ul></li><li><strong>Replication</strong><ul><li><a href=/40123345-posts/42-Code/42.03-AWS/Databases/Amazon-RDS-Relational-Database-Service rel=noopener class=internal-link data-src=/40123345-posts/42-Code/42.03-AWS/Databases/Amazon-RDS-Relational-Database-Service>RDS</a> Replication, <a href=/40123345-posts/42-Code/42.03-AWS/Databases/Amazon-Aurora rel=noopener class=internal-link data-src=/40123345-posts/42-Code/42.03-AWS/Databases/Amazon-Aurora>Aurora</a> + Global Database</li><li>Database relication từ on-premise lên <a href=/40123345-posts/42-Code/42.03-AWS/Databases/Amazon-RDS-Relational-Database-Service rel=noopener class=internal-link data-src=/40123345-posts/42-Code/42.03-AWS/Databases/Amazon-RDS-Relational-Database-Service>RDS</a>.</li><li>Storage Gateway</li></ul></li><li><strong>Automation</strong><ul><li>CloudFormation/<a href=/40123345-posts/42-Code/42.03-AWS/Elastic-Beanstalk rel=noopener class=internal-link data-src=/40123345-posts/42-Code/42.03-AWS/Elastic-Beanstalk>Elastic Beanstalk</a> để tạo lại toàn bộ hệ thống trên môi trường mới.</li><li>Recover/Reboost thông qua <a href=/40123345-posts/42-Code/42.03-AWS/Monitoring/Amazon-CloudWatch rel=noopener class=internal-link data-src=/40123345-posts/42-Code/42.03-AWS/Monitoring/Amazon-CloudWatch>CloudWatch</a> nếu nó có alarm lỗi.</li><li>Dùng <a href=/40123345-posts/42-Code/42.03-AWS/AWS-Lambda rel=noopener class=internal-link data-src=/40123345-posts/42-Code/42.03-AWS/AWS-Lambda>AWS Lambda</a> Function để thực hiện tự động các tác vụ chỉ định.</li></ul></li><li><strong>Chaos</strong><ul><li>Kiểm thử, như Netflix đặt toàn bộ tài nguyên trên AWS Cloud, có một thuật ngữ &ldquo;simian-army&rdquo;. Là kiểu kiểm thử khả năng DC của hệ thống - random terminate EC2 của production luôn chứ không phải của môi tường test luôn =)))</li></ul></li></ul><div id=modalShowImage class=modal><span class=close>&#215;</span>
<img class=modal-content id=modal-content-img></div><script>$(".myImg").on("click",function(){$("#modalShowImage").css("display","block"),$("#modal-content-img").attr("src",this.src),$("body").addClass("modal-open")}),$("#modalShowImage").on("hidden.bs.modal",function(){$("body").removeClass("modal-open")}),$("#modalShowImage").on("click",".close",function(){$("#modalShowImage").css("display","none"),$("body").removeClass("modal-open")})</script></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li>No backlinks found</li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://anhhn.netlify.app/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by anhnh using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2023</p><ul><li><a href=https://anhhn.netlify.app/>Home</a></li><li><a href="https://www.facebook.com/profile.php?id=100026527598703">Facebook</a></li><li><a href=https://github.com/anhnh-3008>Github</a></li></ul></footer></div></div></body></html>